# ADR-0001: Agents 시스템 도입 (v2.0.0)

**Date**: 2025-12-09
**Status**: Superseded by ADR-0003 (v3.0.0 Agents 축소)

## Context

v1.6.0까지 workflow-skills는 Skills만으로 구성되어 있었습니다. Skills는 다단계 워크플로우를 오케스트레이션하는 데 탁월하지만, 특정 기술 작업(리팩토링, 테스트 생성)을 자동화하기에는 너무 무거웠습니다.

## Problem

- **중복 로직**: analyze-issue, execute-plan 모두 복잡도 분석 로직 중복
- **재사용성 부족**: 리팩토링, 테스트 생성 로직을 다른 Skills에서 활용 불가
- **Skills 비대화**: 단일 Skill이 너무 많은 책임을 담당 (SRP 위반)
- **유지보수 어려움**: 로직 수정 시 여러 Skills 동시 수정 필요

## Decision

### Skills + Agents 아키텍처 도입

1. **명확한 역할 분리**:
   - **Skills**: 워크플로우 오케스트레이션 (6-9 phases, 복잡도 높음)
   - **Agents**: 특정 기술 작업 자동화 (4-5 phases, 단일 책임)

2. **4개 핵심 Agents 추가**:
   - `code-refactorer`: Cyclomatic complexity > 10 → Extract Method/Class
   - `test-generator`: 테스트 누락 파일 자동 생성
   - `performance-analyzer`: N+1 query, 번들 크기 탐지
   - `code-reviewer`: SOLID 원칙, Code Smell 검증

3. **통합 지점**:
   - analyze-issue → Phase 3D (code-refactorer)
   - execute-plan → Phase 4C (DB Migration), Phase 5 (test-generator)
   - mr-code-review → Phase 4 (의존성 보안)

4. **plugin.json 도입**:
   ```json
   {
     "name": "workflow-skills",
     "version": "2.0.0",
     "skills": ["./analyze-issue", ...],
     "agents": "./agents"
   }
   ```

## Impact

- **Breaking Change**: v1.6.0 → v2.0.0
- **재사용성 향상**: Agents를 여러 Skills에서 호출 가능
- **유지보수성 개선**: 로직 변경 시 Agent 파일만 수정
- **확장성**: 새 Agent 추가 시 기존 Skills 수정 불필요

## Alternatives

1. ❌ Skills만 유지 + 로직 중복 허용 → 장기적 유지보수 부담
2. ❌ 외부 라이브러리/도구 사용 → MCP 통합 필요, 일관성 부족
3. ✅ **Skills + Agents 아키텍처** → 채택

## Pattern

**Composition over Inheritance (in workflow design)**
- Skill이 모든 기능을 직접 구현 → Agent를 조합하여 복잡한 워크플로우 구성

## Related Files

- `.claude-plugin/plugin.json` - Plugin manifest
- `agents/code-refactorer.md` - Refactoring Agent
- `agents/test-generator.md` - Test generation Agent
- `analyze-issue/SKILL.md` - Phase 3D 추가
- `execute-plan/SKILL.md` - Phase 4C, Phase 5 추가

## Lessons Learned

- 새로운 기술 작업 추가 시 Skill이 아닌 Agent로 구현
- Skills는 워크플로우 조율에만 집중
- Agent는 단일 책임 원칙(SRP) 엄격히 준수
