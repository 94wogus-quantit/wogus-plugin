[
  {
    "file": "app/services/cognito.py",
    "line": 116,
    "severity": "ğŸ”´ Critical",
    "title": "SQL Injection ì·¨ì•½ì ",
    "description": "ì‚¬ìš©ì ì…ë ¥ì´ ì§ì ‘ ì¿¼ë¦¬ì— ì‚¬ìš©ë˜ì–´ SQL Injection ê³µê²©ì— ì·¨ì•½í•©ë‹ˆë‹¤. ê³µê²©ìê°€ ì•…ì˜ì ì¸ SQL êµ¬ë¬¸ì„ ì‚½ì…í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "current_code": "query = f\"SELECT * FROM users WHERE id = {user_id}\"",
    "suggested_code": "query = \"SELECT * FROM users WHERE id = %s\"\ncursor.execute(query, (user_id,))",
    "reason": "Prepared Statementë¥¼ ì‚¬ìš©í•˜ì—¬ SQL Injectionì„ ë°©ì§€í•©ë‹ˆë‹¤. ì‚¬ìš©ì ì…ë ¥ì´ ì¿¼ë¦¬ ë¬¸ìì—´ì— ì§ì ‘ í¬í•¨ë˜ì§€ ì•Šê³  íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë©ë‹ˆë‹¤."
  },
  {
    "file": "src/api/user.ts",
    "line": 42,
    "severity": "ğŸŸ¡ High",
    "title": "ì—ëŸ¬ í•¸ë“¤ë§ ëˆ„ë½",
    "description": "async í•¨ìˆ˜ì—ì„œ try-catch ì—†ì´ ì™¸ë¶€ APIë¥¼ í˜¸ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì‹œ unhandled promise rejectionì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    "current_code": "const response = await externalApi.fetchUser(userId);",
    "suggested_code": "try {\n  const response = await externalApi.fetchUser(userId);\n  return response;\n} catch (error) {\n  logger.error('Failed to fetch user', { userId, error });\n  throw new UserFetchError(userId, error);\n}",
    "reason": "ì™¸ë¶€ API í˜¸ì¶œì€ í•­ìƒ ì‹¤íŒ¨ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ ì ì ˆí•œ ì—ëŸ¬ í•¸ë“¤ë§ì´ í•„ìš”í•©ë‹ˆë‹¤."
  },
  {
    "file": "src/utils/validation.ts",
    "line": 78,
    "severity": "ğŸŸ¢ Medium",
    "title": "ì •ê·œì‹ ìµœì í™” ê°€ëŠ¥",
    "description": "ì´ë©”ì¼ ê²€ì¦ ì •ê·œì‹ì´ ë§¤ìš° ë³µì¡í•˜ì—¬ ReDoS(Regular Expression Denial of Service) ì·¨ì•½ì  ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤.",
    "current_code": "const emailRegex = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;",
    "suggested_code": "import { isEmail } from 'validator';\n// ë˜ëŠ” ê°„ë‹¨í•œ ì •ê·œì‹ ì‚¬ìš©\nconst emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;",
    "reason": "ê²€ì¦ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ê°„ë‹¨í•œ ì •ê·œì‹ìœ¼ë¡œ ê¸°ë³¸ ê²€ì¦ í›„ ì‹¤ì œ ì´ë©”ì¼ í™•ì¸ì€ ë°œì†¡ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•ˆì „í•©ë‹ˆë‹¤."
  }
]
